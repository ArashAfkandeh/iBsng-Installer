
# مدیریت و پشتیبان‌گیری خودکار IBSng با تلگرام

\<div dir="rtl"\>

## 🌟 معرفی

این پروژه یک راهکار کامل و خودکار برای **نصب، مدیریت و پشتیبان‌گیری از سرویس IBSng** با استفاده از Docker است که با یک ربات تلگرام ادغام شده است. با این ابزار می‌توانید به راحتی سرویس IBSng را راه‌اندازی کرده و از پایگاه داده آن به صورت منظم و خودکار نسخه پشتیبان تهیه کنید. فایل‌های پشتیبان به طور مستقیم به چت تلگرام شما ارسال می‌شوند و شما می‌توانید از طریق دستورات ربات، عملیات پشتیبان‌گیری و بازیابی را مدیریت کنید.

## 🎯 ویژگی‌های کلیدی

  - ✅ **نصب سریع و آسان IBSng**: راه‌اندازی کامل سرویس IBSng تنها با یک دستور و با استفاده از Docker.
  - 💾 **ذخیره‌سازی پایدار داده‌ها**: تمامی اطلاعات پایگاه داده بر روی هاست ذخیره می‌شود تا با حذف یا آپدیت کانتینر از بین نرود.
  - 🤖 **ادغام کامل با تلگرام**:
      - **ارسال خودکار بکاپ**: فایل‌های پشتیبان به صورت خودکار به چت یا کانال تلگرام شما ارسال می‌شوند.
      - **ربات مدیریتی**: با دستورات ساده به ربات، سرویس خود را مدیریت کنید.
  - 🔄 **پشتیبان‌گیری هوشمند**:
      - **زمان‌بندی خودکار**: بکاپ‌گیری در فواصل زمانی مشخص (مثلاً هر ۱ ساعت) به صورت خودکار انجام می‌شود.
      - **بکاپ‌گیری دستی**: هر زمان که بخواهید، با دستور `/backup` یک نسخه پشتیبان جدید ایجاد کنید.
  - 🚀 **بازیابی آسان و سریع**:
      - **بازیابی از طریق تلگرام**: فایل بکاپ را برای ربات ارسال کنید تا عملیات بازیابی به صورت خودکار انجام شود.
      - **شناسایی هوشمند فرمت**: اسکریپت به طور خودکار فرمت‌های مختلف بکاپ (`.dump.gz` یا `.bak`) را تشخیص می‌دهد.
  - 📊 **بررسی وضعیت**: با دستور `/status` از وضعیت آخرین بکاپ و زمان آن مطلع شوید.
  - ⚙️ **سرویس پایدار Systemd**: اسکریپت پشتیبان‌گیری به عنوان یک سرویس دائمی در پس‌زمینه اجرا می‌شود تا همیشه فعال بماند.
  - 🔒 **امنیت و سادگی**: تنظیمات ربات تلگرام در یک فایل `config.json` به سادگی قابل ویرایش است و دسترسی به دستورات حساس محدود به مدیر ربات است.

## ⚡ نصب سریع

برای نصب سریع، دستور زیر را در ترمینال سرور خود (با دسترسی root) اجرا کنید:

```bash
curl -sSL https://raw.githubusercontent.com/ArashAfkandeh/iBsng-Installer/main/install_ibsng.sh | sudo bash
```

اسکریپت نصب به طور خودکار Docker و پیش‌نیازها را نصب کرده و سرویس IBSng را راه‌اندازی می‌کند. در حین نصب، اطلاعات ربات تلگرام از شما پرسیده می‌شود.

## 🛠️ پیکربندی ربات تلگرام

پس از اتمام نصب، برای فعال‌سازی ربات تلگرام، باید اطلاعات توکن و شناسه چت خود را وارد کنید. اگر در حین نصب این اطلاعات را وارد نکرده‌اید، می‌توانید فایل زیر را به صورت دستی ایجاد و ویرایش کنید:

**مسیر فایل:** `/root/ibsng_backup/config.json`

محتوای فایل باید به شکل زیر باشد:

```json
{
  "bot_token": "TOKEN_BOT_TELEGRAM_SHOMA",
  "chat_id": "CHAT_ID_TELEGRAM_SHOMA"
}
```

  - `bot_token`: توکن ربات تلگرام که از [BotFather](https://t.me/BotFather) دریافت می‌کنید.
  - `chat_id`: شناسه عددی چت، کاربر یا کانالی که می‌خواهید بکاپ‌ها به آنجا ارسال شود.

پس از ذخیره فایل، سرویس بکاپ را ریستارت کنید:

```bash
sudo systemctl restart ibsng-backup.service
```

## 🎮 دستورات ربات تلگرام

شما می‌توانید با ارسال دستورات زیر به ربات تلگرام خود، سرویس را مدیریت کنید:

| دستور      | توضیحات                                                                                                                              |
| :--------- | :------------------------------------------------------------------------------------------------------------------------------------ |
| `/backup`  | **شروع عملیات پشتیبان‌گیری دستی**: بلافاصله یک نسخه پشتیبان جدید از پایگاه داده تهیه و به تلگرام ارسال می‌کند.                        |
| `/restore` | **شروع عملیات بازیابی**: ربات از شما می‌خواهد فایل بکاپ (`.dump.gz` یا `.bak`) را ارسال کنید تا پایگاه داده را بازیابی کند.         |
| `/status`  | **نمایش وضعیت**: زمان آخرین بکاپ موفق و مدت زمان گذشته از آن را نمایش می‌دهد.                                                     |
| `/cancel`  | **لغو عملیات**: فرآیند بازیابی را در صورتی که منتظر دریافت فایل باشد، لغو می‌کند.                                              |

-----

### **نمایی از عملکرد ربات**

1.  **پشتیبان‌گیری خودکار و ارسال به تلگرام:**

2.  **بازیابی با ارسال فایل به ربات:**

## 🔧 مدیریت سرویس

برای مدیریت کانتینر Docker و سرویس پشتیبان‌گیری می‌توانید از دستورات زیر استفاده کنید:

  - **مشاهده لاگ‌های سرویس بکاپ:**

    ```bash
    journalctl -u ibsng-backup.service -f
    ```

  - **مدیریت کانتینر IBSng:**
    به مسیر `/opt/ibsng` بروید و از دستورات `docker compose` استفاده کنید:

    ```bash
    cd /opt/ibsng
    docker compose logs -f   # مشاهده لاگ‌های IBSng
    docker compose down      # متوقف کردن سرویس
    docker compose up -d     # راه‌اندازی مجدد سرویس
    ```

## 📄 مجوز (License)

این پروژه تحت مجوز **MIT** منتشر شده است. برای اطلاعات بیشتر فایل `LICENSE` را مطالعه کنید.

\</div\>
